var root = document.documentElement;
var elms = [];

function openNav() {
	document.getElementById("mySidenav").style.left = "0px";
	document.getElementById("topSideNavBar").style.left = "0px";
	if (window.innerWidth > 1024){
		document.getElementById('themebtn').style.opacity = "1";
		root.style.setProperty("--navCloseable", "false");
		document.getElementById('main').style.marginLeft = "250px";
	} else {
		try {
			document.getElementById("overlay").style.left = "0px";
			document.getElementById("overlay").style.opacity = "0.5";
		} catch (TypeError) {}
		document.getElementById('themebtn').style.opacity = "0.99";
		root.style.setProperty("--navCloseable", "true");
	}
}

function closeNav() {
	try {
		setTimeout(function(){document.getElementById("overlay").style.left = "200%";},500);
		document.getElementById("overlay").style.opacity = "0";
	} catch (TypeError) {}
	document.getElementById('main').style.marginLeft = "0px";
	document.getElementById("mySidenav").style.left = "-250px";
	document.getElementById("topSideNavBar").style.left = "-250px";
	
}

function testclose(){
	try {
		//var x = (document.getElementById('themebtn').style.opacity == "0.99" || document.getElementById('v0').hidden);
		var x = (root.style.getPropertyValue("--navCloseable") == 'true');
	} catch (ReferenceError) {
		var x = false;
	}
	if (x){
		if (window.innerWidth <= 750){
			var myElements = document.querySelectorAll("h2");
			for (var i = 0; i < myElements.length; i++) {
				myElements[i].style.paddingTop = "60px";
			}
		}
		closeNav();
	} else {
		var myElements = document.querySelectorAll("h2");
		for (var i = 0; i < myElements.length; i++) {
			myElements[i].style.paddingTop = "10px";
		}
	}
	setTimeout(function(){setCookie('lastPage', window.location.href, 30);},20);
}

function sub(id){
	var cid = "c" + id;
	var gid = "g" + id;
	var caret = document.getElementById(cid);
	var group = document.getElementById(gid);
	if (group.hidden){
		group.hidden = false;
		caret.classList.add('fa-caret-down');
		caret.classList.remove('fa-caret-right');
	} else {
		group.hidden = true;
		caret.classList.add('fa-caret-right');
		caret.classList.remove('fa-caret-down');
	}
}

var dark_mode = Number(getPref("dark_mode"));
function theme(t, s){
	t = t || 0; //0 = Toggle; 1 = Light; 2 = Dark
	s = s || 'true';
	
	switch (t) {
		case 0:
			break;
		case 1:
			document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-sun-o"> </i>';
			break;
		case 2:
			document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-moon-o"> </i>';
			break;
	}
	
	if (document.getElementById('themebtn').innerHTML == '<i class="fa fa-fw fa-moon-o"> </i>'){
		//Set Dark Mode
		document.body.style.backgroundColor = "#000";
		
		document.body.style.color = "#8c8c8c";
		document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-sun-o"> </i>';
		document.getElementById("homeSvg").style.fill = "#8c8c8c";
		
		//Set Accordions if Found
		var accords = document.getElementsByClassName("accordControls");
		if (accords.length > 0) {
			for (a = 0; a < accords.length; a++) {
				accords[a].style.backgroundColor = "#333";
				//Text inside gets delayed otherwise
				document.getElementById(accords[a].id + "l").style.transition = "0.5s";
				document.getElementById(accords[a].id + "l").style.color = "#8c8c8c";
				document.querySelector("#" + accords[a].id + "content ol").style.transition = "0.5s";
				document.querySelector("#" + accords[a].id + "content ol").style.color = "#8c8c8c";
				document.getElementById(accords[a].id + "content").style.backgroundColor = "#222";
			}
		}
		
		//Flex Images
		var imgs = document.querySelectorAll('.flex img, .flex video[canBeDark]');
		if (imgs.length > 0) imgs.forEach(function(img){
			img.classList.add('dark');
		});
		
		if (s == 'true'){
			setPref("dark_mode", true);
			console.log("Saved Dark Mode");
		}
		
		/*setTimeout(function(){
			var doc = document.getElementById('i1').contentWindow.document;
			console.log(doc);
			doc.body.style.backgroundColor = "black"; console.log("hi");
		}, 10);/**/
		
	} else {
		//Set Light Mode
		document.body.style.backgroundColor = "#fff";
		
		document.body.style.color = "#000";
		document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-moon-o"> </i>';
		document.getElementById("homeSvg").style.fill = "black";
		
		//Set Accordions if Found
		var accords = document.getElementsByClassName("accordControls");
		if (accords.length > 0) {
			for (a = 0; a < accords.length; a++) {
				accords[a].style.backgroundColor = "#eee";
				//Text inside gets delayed otherwise
				document.getElementById(accords[a].id + "l").style.transition = "0.5s";
				document.getElementById(accords[a].id + "l").style.color = "black";
				document.querySelector("#" + accords[a].id + "content ol").style.transition = "0.5s";
				document.querySelector("#" + accords[a].id + "content ol").style.color = "black";
				document.getElementById(accords[a].id + "content").style.backgroundColor = "#f8f8f8";
			}
		}
		
		//Flex Images
		var imgs = document.querySelectorAll('.flex img, .flex video[canBeDark]');
		if (imgs.length > 0) imgs.forEach(function(img){
			img.classList.remove('dark');
		});
		
		if (s == 'true'){
			setPref("dark_mode", false);
			console.log("Saved Light Mode");
		}
	}
	document.getElementById('themebtn2').innerHTML = document.getElementById('themebtn').innerHTML;
}

//Access Cookies

function setCookie(cname,cvalue,exdays) {
	var d = new Date();
	d.setTime(d.getTime() + (exdays*24*60*60*1000));
	var expires = "expires=" + d.toGMTString();
	document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
	var name = cname + "=";
	var decodedCookie = decodeURIComponent(document.cookie);
	var ca = decodedCookie.split(';');
	for( var i = 0; i < ca.length; i++ ){
		var c = ca[i];
		while (c.charAt(0) == ' ') {
			c = c.substring(1);
		}
		if (c.indexOf(name) == 0) {
			return c.substring(name.length, c.length);
		}
	}
	return "";
}

function checkCookie(cname) {
	var user = getCookie(cname);
	if (user != "") {
		alert("Welcome again " + user);
	} else {
		user = prompt("Please enter your name:","");
		if (user != "" && user != null) {
			setCookie(cname, user, 30);
		}
	}
}

if (getPref("dark_mode") && window.location.href !== "https://awesome-e.github.io/hs-tools/" ) {
	theme(2);
}
