var root = document.documentElement;
var elms = [];

function openNav() {
	document.getElementById("mySidenav").style.left = "0px";
	document.getElementById("topSideNavBar").style.left = "0px";
	if (window.innerWidth > 1024){
		document.getElementById('themebtn').style.opacity = "1";
		root.style.setProperty("--navCloseable", "false");
	document.getElementById('main').style.marginLeft = "250px";
	} else {
		document.getElementById('themebtn').style.opacity = "0.99";
		root.style.setProperty("--navCloseable", "true");
		//Darken Links Text
		for (link of document.getElementById('main').getElementsByTagName('a')){
			link.style.color = "#1f8e76";
		}
		for (link of document.getElementsByClassName('link')){
			link.style.backgroundColor = "#0b5b51";
			link.style.color = "gray";
		}
	if (document.getElementById('themebtn').innerHTML == '<i class="fa fa-fw fa-moon-o"> </i>'){
		document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
		
		elms = document.getElementsByClassName('cover')
		for (var i = 0; i < elms.length; i ++) {
			elms[i].style.backgroundColor = "rgba(0,0,0,0.4)";
		}
	} else {
		document.body.style.backgroundColor = "rgba(0,0,0,0.7)";
		
		elms = document.getElementsByClassName('cover')
		for (var i = 0; i < elms.length; i ++) {
			elms[i].style.backgroundColor = "rgba(0,0,0,0.7)";
		}
	}
	}
}

function closeNav() {
	document.getElementById('main').style.marginLeft = "0px";
	document.getElementById("mySidenav").style.left = "-250px";
	document.getElementById("topSideNavBar").style.left = "-250px";
	//Lighten Links Text
	for (link of document.getElementById('main').getElementsByTagName('a')){
			link.style.color = "#50d8bb";
	}
	for (link of document.getElementsByClassName('link')){
		link.style.backgroundColor = "#0d6f62";
		link.style.color = "white";
	}
	if (document.getElementById('themebtn').innerHTML == '<i class="fa fa-fw fa-moon-o"> </i>'){
		document.body.style.backgroundColor = "white";
		
		elms = document.getElementsByClassName('cover')
		for (var i = 0; i < elms.length; i ++) {
			elms[i].style.backgroundColor = "rgba(0,0,0,0)";
		}
	} else {
		document.body.style.backgroundColor = "black";
		
		elms = document.getElementsByClassName('cover')
		for (var i = 0; i < elms.length; i ++) {
			elms[i].style.backgroundColor = "rgba(0,0,0,0.5)";
		}
	}
}

function testclose(){
	try {
		//var x = (document.getElementById('themebtn').style.opacity == "0.99" || document.getElementById('v0').hidden);
		var x = (root.style.getPropertyValue("--navCloseable") == 'true');
	} catch (ReferenceError) {
		var x = false;
	}
	if (x){
		if (window.innerWidth <= 750){
			var myElements = document.querySelectorAll("h2");
			for (var i = 0; i < myElements.length; i++) {
				myElements[i].style.paddingTop = "60px";
			}
		}
		closeNav();
	} else {
		var myElements = document.querySelectorAll("h2");
		for (var i = 0; i < myElements.length; i++) {
			myElements[i].style.paddingTop = "10px";
		}
	}
	setTimeout(function(){setCookie('lastPage', window.location.href, 30);},20);
}

function sub(id){
	var cid = "c" + id;
	var gid = "g" + id;
	var caret = document.getElementById(cid);
	var group = document.getElementById(gid);
	if (group.hidden){
		group.hidden = false;
		caret.classList.add('fa-caret-down');
		caret.classList.remove('fa-caret-right');
	} else {
		group.hidden = true;
		caret.classList.add('fa-caret-right');
		caret.classList.remove('fa-caret-down');
	}
}

var dark_mode = Number(getCookie("dark_mode") == "true");
function theme(t, s){
	t = t || 0; //0 = Toggle; 1 = Light; 2 = Dark
	s = s || 'true';
	
	switch (t) {
		case 0:
			break;
		case 1:
			document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-sun-o"> </i>';
			break;
		case 2:
			document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-moon-o"> </i>';
			break;
	}
	
	if (document.getElementById('themebtn').innerHTML == '<i class="fa fa-fw fa-moon-o"> </i>'){
		//Set Dark Mode
		if (document.getElementById("mySidenav").style.left == "0px" && document.getElementById('themebtn').style.opacity == "0.99"){ /* If sidebar is open */
			document.body.style.backgroundColor = "rgba(0,0,0,0.7)";
		
			elms = document.getElementsByClassName('cover')
			for (var i = 0; i < elms.length; i ++) {
				elms[i].style.backgroundColor = "rgba(0,0,0,0.7)";
			}
		} else {
			document.body.style.backgroundColor = "#000";
		
			elms = document.getElementsByClassName('cover')
			for (var i = 0; i < elms.length; i ++) {
				elms[i].style.backgroundColor = "rgba(0,0,0,0.5)";
			}
		}
		document.body.style.color = "#8c8c8c";
		document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-sun-o"> </i>';
		//document.getElementById("linksPopout").classList.add("dark");
		document.getElementById("homeSvg").style.fill = "#8c8c8c";
		if (s == 'true'){
			setCookie("dark_mode", "true", 30);
			console.log("Saved Dark Mode");
		}
		
		/*setTimeout(function(){
			var doc = document.getElementById('i1').contentWindow.document;
			console.log(doc);
			doc.body.style.backgroundColor = "black"; console.log("hi");
		}, 10);/**/
		
	} else {
		//Set Light Mode
		if (document.getElementById("mySidenav").style.left == "0px" && document.getElementById('themebtn').style.opacity == "0.99"){
			document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
		
			elms = document.getElementsByClassName('cover')
			for (var i = 0; i < elms.length; i ++) {
				elms[i].style.backgroundColor = "rgba(0,0,0,0.4)";
			}
		} else {
			document.body.style.backgroundColor = "#fff";
		
			elms = document.getElementsByClassName('cover')
			for (var i = 0; i < elms.length; i ++) {
				elms[i].style.backgroundColor = "rgba(0,0,0,0)";
			}
		}
		document.body.style.color = "#000";
		document.getElementById('themebtn').innerHTML = '<i class="fa fa-fw fa-moon-o"> </i>';
		//document.getElementById("linksPopout").classList.remove("dark");
		document.getElementById("homeSvg").style.fill = "black";
		if (s == 'true'){
			setCookie("dark_mode", "false", 30);
			console.log("Saved Light Mode");
		}
	}
	document.getElementById('themebtn2').innerHTML = document.getElementById('themebtn').innerHTML;
}

function setCookie(cname,cvalue,exdays) {
	var d = new Date();
	d.setTime(d.getTime() + (exdays*24*60*60*1000));
	var expires = "expires=" + d.toGMTString();
	document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
	var name = cname + "=";
	var decodedCookie = decodeURIComponent(document.cookie);
	var ca = decodedCookie.split(';');
	for( var i = 0; i < ca.length; i++ ){
		var c = ca[i];
		while (c.charAt(0) == ' ') {
			c = c.substring(1);
		}
		if (c.indexOf(name) == 0) {
			return c.substring(name.length, c.length);
		}
	}
	return "";
}

function checkCookie(cname) {
	var user = getCookie(cname);
	if (user != "") {
		alert("Welcome again " + user);
	} else {
		user = prompt("Please enter your name:","");
		if (user != "" && user != null) {
			setCookie(cname, user, 30);
		}
	}
}

if (getCookie("dark_mode") == 'true' && window.location.href !== "https://awesome-e.github.io/hs-tools/" ) {
	theme(2);
}
