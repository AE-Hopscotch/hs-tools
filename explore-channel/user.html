<!doctype html>
<html>
	<head>
		<title>Hopscotch Web Explorer</title>
		<link href='https://fonts.googleapis.com/css?family=Dancing%20Script' rel='stylesheet'>
		<link href='https://fonts.googleapis.com/css?family=Lilita%20One' rel='stylesheet'>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="../style.css">
		<link rel="stylesheet" href="browserstyle.css">
		<link rel="icon" type="image/png" sizes="32x32" href="/hs-tools/icons/favicon-32x32.png">
		<link rel="icon" type="image/png" href="https://aws1.discourse-cdn.com/gethopscotch/original/3X/3/8/3836ff26c18740a553e96462dc1ece3d8e7f4869.png">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		
		<link rel="apple-touch-icon" sizes="180x180" href="/hs-tools/icons/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/hs-tools/icons/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/hs-tools/icons/favicon-16x16.png">
		<link rel="manifest" href="/hs-tools/icons/site.webmanifest">
		<link rel="mask-icon" href="/hs-tools/icons/safari-pinned-tab.svg" color="#5bbad5">
		<link rel="shortcut icon" href="/hs-tools/icons/favicon.ico">
		<meta name="apple-mobile-web-app-title" content="Hopscotch Tools">
		<meta name="application-name" content="Hopscotch Tools">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="msapplication-config" content="/hs-tools/icons/browserconfig.xml">
		<meta name="theme-color" content="#ffffff">
		
		<script src='../lib/hexauid.js'></script>
		
		<style>
			.topnav {
				background-color: var(--col-bg-toolbar);
				display: block;
				width: calc(100% + 16px);
				position: relative;
				margin: -8px;
				top: 0px;
				left: 0px;
				overflow-x: auto;
				padding-top: 56px;
				z-index: 10;
				border-bottom: var(--col-low-border);
				color: var(--col-label-text);
				transition: color var(--transition-time), background-color var(--transition-time), border-bottom var(--transition-time);
        background-color: var(--col-bg-toolbar);
        text-align: center;
			}
			.topnav img {
				display: block;
				margin: 16px auto;
				width: 128px;
				border-radius: 50%;
			}
			.retro .topnav img {
				width: 96px;
			}
			.topnav span {
				display: block;
				text-align: center;
				font-family: Avenir;
			}
			.topnav button {
				width: calc(50% - 0px);
				margin: 0;
			}
      .topnav .flex {
        flex-wrap: nowrap;
      }
      .topnav .flex > * {
        width: 100%;
        flex-basis: 33.3%;
      }
      .topnav .flex .badge-container {
        min-width: none;
        z-index: 2;
        position: relative;
        padding: 16px;
        text-align: left;
      }
      @media only screen and (max-width: 700px) {
        .topnav .flex {
          flex-wrap: wrap;
        }
        .topnav .flex > * {
          flex-basis: 100%;
        }
        .topnav .flex > *:first-child {
          display: none;
        }
        .topnav .flex .badge-container {
          text-align: center;
        }
      }
			
			#loadingBear {
				top: calc(50% + 80px);
			}
		</style>
	</head>
	<body>
		<button class="uiBtn" style="position: fixed; left: 0px; bottom: 0px; z-index: 5;" onclick="theme_()" id="themebtn"><i class="fa fa-fw fa-moon-o"> </i></button>
		<button id="xray-toggle-btn" class="uiBtn" style="bottom: 30px; left: 0; z-index: 2;" onclick="xray('toggle-status')"><i class="fa fa-fw fa-crosshairs"> </i></button>
		<button id="xray-show-btn" class="uiBtn xray-contents" style="bottom: 194px; margin: 0" onclick="xray('toggle-show')"><i class="fa fa-fw fa-eye"> </i></button>
		<button id="xray-clickact-btn" class="uiBtn xray-contents" style="bottom: 218px; margin: 0" onclick="xray('click-action')"></button>
		<div class="xray-contents">
			<span id="zoom-display">100</span>
			<input oninput="document.querySelector('#zoom-display').innerHTML=Math.floor(this.value*100);document.documentElement.style.setProperty('--x-ray-zoom', this.value);localStorage.setItem('webExpZoom', this.value);" type="range" orient="vertical" step="0.02" value="1" min="0.1" max="2"/>
		</div>
		
		<sq>
			<a href="javascript:home()" style="display:block;"><svg id="homeSvg" style="fill:#eee;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 460.298 460.297" style="enable-background:new 0 0 460.298 460.297;" xml:space="preserve"><g><g><path d="M230.149,120.939L65.986,256.274c0,0.191-0.048,0.472-0.144,0.855c-0.094,0.38-0.144,0.656-0.144,0.852v137.041c0,4.948,1.809,9.236,5.426,12.847c3.616,3.613,7.898,5.431,12.847,5.431h109.63V303.664h73.097v109.64h109.629c4.948,0,9.236-1.814,12.847-5.435c3.617-3.607,5.432-7.898,5.432-12.847V257.981c0-0.76-0.104-1.334-0.288-1.707L230.149,120.939z"/><path d="M457.122,225.438L394.6,173.476V56.989c0-2.663-0.856-4.853-2.574-6.567c-1.704-1.712-3.894-2.568-6.563-2.568h-54.816c-2.666,0-4.855,0.856-6.57,2.568c-1.711,1.714-2.566,3.905-2.566,6.567v55.673l-69.662-58.245c-6.084-4.949-13.318-7.423-21.694-7.423c-8.375,0-15.608,2.474-21.698,7.423L3.172,225.438c-1.903,1.52-2.946,3.566-3.14,6.136c-0.193,2.568,0.472,4.811,1.997,6.713l17.701,21.128c1.525,1.712,3.521,2.759,5.996,3.142c2.285,0.192,4.57-0.476,6.855-1.998L230.149,95.817l197.57,164.741c1.526,1.328,3.521,1.991,5.996,1.991h0.858c2.471-0.376,4.463-1.43,5.996-3.138l17.703-21.125c1.522-1.906,2.189-4.145,1.991-6.716C460.068,229.007,459.021,226.961,457.122,225.438z"/></g></g></svg></a>
		</sq>
		<div class="topSticky">
			<a class="back" onclick="back()"><i class="fa fa-angle-left"></i></a>
			<h1>&ic;</h1>
		</div>
		<div class="topnav">
			<div class="flex" style="justify-content: center;">
        <div><i>&nbsp;</i></div>
				<div style="min-width:none;padding:16px">
					<img src="../images/loading_apple.gif" alt="Profile Picture"
            style="padding: 30px;"
            onload="if(!this.src.match(/loading_apple/))this.style.padding=0">
					<span>Hopscotchin&rsquo; since</span>
				</div>
        <div class="badge-container"></div>
			</div><br>
			<button onclick="showChannel('Published')">Published</button><button onclick="showChannel('Favorites')">Favorites</button>
		</div><br>
		<div class="flex">
			<textarea readonly id="copytext" style="position: fixed; left: -1000px; width: 100px;"></textarea>
			<span style="display:none;" id="ins-before"></span>
		</div>

		<div id="loadingBear">
		</div>

		<script src="../main.js"></script>
		<script src="projectbrowser.js"></script>
		<!--script src="https://cdnjs.cloudflare.com/ajax/libs/color-thief/2.3.0/color-thief.umd.js"></script-->
		<script src="color-thief.js"></script>
		<script src='https://cdn.rawgit.com/naptha/tesseract.js/1.0.10/dist/tesseract.js'></script>
		<script>
			var names = {
				"Published": "published_projects",
				"Favorites": "favorite_projects"
			}
				
			var path = "categories/best_of/featured";
			function showChannel(channel) {
				path = names[channel];
				
				//Format the buttons
				document.querySelectorAll(".topnav button").forEach(function(btn){
					if (btn.innerHTML.replace(/You found/,"Published").replace(/Eâ€™s Picks/,"Favorites") == channel) btn.setAttribute("class", "selected"); else btn.removeAttribute("class");
				});
				
				//Remove all existing project cards
				$(".project-card").remove();
				
				page = 1;
				document.getElementById("loadingBear").innerHTML = bearSvg;
				document.getElementById("loadingBear").style.display = "";
				document.body.scrollTop = 0; // For Safari
				document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
				request(`https://community.gethopscotch.com/api/v2/users/${user.id}/${path}?page=${page}&api_token=4f7769439adf7ef8e482d2daef77375cd6d0158b65fcdca543b74b5c0c92&user%5Bauth_token%5D=qKok4lCx8YB9Wgp%2Bo862AA%3D%3D&user%5Bid%5D=4753230`);
				
				replaceLocation(`?u=${userString}&channel=${encodeURIComponent(channel)}`);
			}
			
			$(window).scroll(function() {
			   if($(window).scrollTop() + $(window).height() > $(document).height() - 10 && !busy) {
				   request(`https://community.gethopscotch.com/api/v2/users/${user.id}/${path}?page=${page}&api_token=4f7769439adf7ef8e482d2daef77375cd6d0158b65fcdca543b74b5c0c92&user%5Bauth_token%5D=qKok4lCx8YB9Wgp%2Bo862AA%3D%3D&user%5Bid%5D=4753230`);
			   }
			});
			
			function doCORSRequest(options, printResult) {
				var x = new XMLHttpRequest();
				x.open(options.method, 'https://corsproxy.io/?' + encodeURIComponent(options.url));
				x.onload = x.onerror = function() {
					var url = new URL(window.location.href);
					var channel = url.searchParams.get("channel");
					console.log(names[url.searchParams.get("channel")] == options.url.replace(/.*?\/api\/v2\/users\/[0-9]*\/|\?.*/gi,''));
					if (names[url.searchParams.get("channel")] == options.url.replace(/.*?\/api\/v2\/users\/[0-9]*\/|\?.*/gi,'')||!/projects/.test(options.url)) {
						printResult(
							//options.method + ' ' + options.url + '\n' +
							//x.status + ' ' + x.statusText + '\n\n' +
							(x.responseText || '')
						);
					}
				};
				if (/^POST/i.test(options.method)) {
				x.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
				}
				x.send(options.data);
			}

			function request(input_url) {
				busy = true;
				doCORSRequest({
					method: 'GET',
					url: input_url,
					//data: dataField.value
				}, function printResult(result) {
					if (showProjects(result) != 'Error') document.getElementById("loadingBear").style.display = "none";
				});
			}
			
			//Display the user information
			var url = new URL(window.location.href);
			var channel = url.searchParams.get("channel");
			var userString = url.searchParams.get("u");
			try {
				//Base64 user encoding
				var user = JSON.parse(decodeURI(window.atob(userString)));
				console.log(user);				
			} catch (SyntaxError) {
				try {
					if ((url.searchParams.get("u")||"").match(/./)) {
						//HexaUID encoding
						var userTraits = url.searchParams.get("u").split("-");
						var user = {
							"nickname": "",
							"id": hexaUID.aidToUuid(userTraits[0]),
							"created_at": (function(d){
									try {return (["January","February","March","April","May","June","July","August","September","October","November","December"])[Number(d.match(/[0-9]{2}$/)[0])-1] + " " + d.match(/[0-9]{4}/)[0]; } catch(e){return"unknown";}
								})(hexaUID.aidToUuid(userTraits[1])),
							"avatar_type": null,
							"remote_avatar_url": (userTraits[2])?"https://hopscotch-images.s3.amazonaws.com/production/images/avatars/"+userTraits[2].split('!').repeatEach((r)=>{return (hexaUID.aidToUuid(r).length==32)?hexaUID.uuidAddDashes(hexaUID.aidToUuid(r)):hexaUID.aidToUuid(r)}).join("-").toUpperCase()+".png":null
						};
						console.log(user);
						//userString = hexaUID.uuidToAid(String(user.id))+"-"+hexaUID.uuidToAid(user.created_at)+((user.remote_avatar_url)?"-" + hexaUID.uuidToAid(user.remote_avatar_url):'');
						//var userString = window.btoa(encodeURI(JSON.stringify(user)));
					} else if (url.searchParams.get("id")||'' != "" && url.searchParams.get("cd")||'' != ""){
						//Check to see if old URL parameters exist
						var user = {
							"nickname": "",
							"id": url.searchParams.get("id"),
							"created_at": (url.searchParams.get("cd")||""),
							"avatar_type": (url.searchParams.get("a")||"")
						};
						console.log(user);
						
						userString = hexaUID.uuidToAid(String(user.id))+"-"+hexaUID.uuidToAid(user.created_at||"unknown 0000")+((user.imgUrl)?"-" + hexaUID.uuidToAid(user.imgUrl):'');
						//var userString = window.btoa(encodeURI(JSON.stringify(user)));
					} else {
						document.documentElement.style.setProperty('--transition-time', '0.5s');
						document.body.innerHTML = '<button class="openbtn" style="position: fixed; left: 0px; bottom: 0px; z-index: 2;" onclick="theme_()" id="themebtn"><i class="fa fa-fw fa-moon-o"> </i></button><sq><a href="javascript:home()" style="display:block;"><svg id="homeSvg" style="fill:#eee;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 460.298 460.297" style="enable-background:new 0 0 460.298 460.297;" xml:space="preserve"><g><g><path d="M230.149,120.939L65.986,256.274c0,0.191-0.048,0.472-0.144,0.855c-0.094,0.38-0.144,0.656-0.144,0.852v137.041c0,4.948,1.809,9.236,5.426,12.847c3.616,3.613,7.898,5.431,12.847,5.431h109.63V303.664h73.097v109.64h109.629c4.948,0,9.236-1.814,12.847-5.435c3.617-3.607,5.432-7.898,5.432-12.847V257.981c0-0.76-0.104-1.334-0.288-1.707L230.149,120.939z"/><path d="M457.122,225.438L394.6,173.476V56.989c0-2.663-0.856-4.853-2.574-6.567c-1.704-1.712-3.894-2.568-6.563-2.568h-54.816c-2.666,0-4.855,0.856-6.57,2.568c-1.711,1.714-2.566,3.905-2.566,6.567v55.673l-69.662-58.245c-6.084-4.949-13.318-7.423-21.694-7.423c-8.375,0-15.608,2.474-21.698,7.423L3.172,225.438c-1.903,1.52-2.946,3.566-3.14,6.136c-0.193,2.568,0.472,4.811,1.997,6.713l17.701,21.128c1.525,1.712,3.521,2.759,5.996,3.142c2.285,0.192,4.57-0.476,6.855-1.998L230.149,95.817l197.57,164.741c1.526,1.328,3.521,1.991,5.996,1.991h0.858c2.471-0.376,4.463-1.43,5.996-3.138l17.703-21.125c1.522-1.906,2.189-4.145,1.991-6.716C460.068,229.007,459.021,226.961,457.122,225.438z"/></g></g></svg></a></sq><div class="topSticky" style="border: none; background-color: rgba(0,0,0,0); transition: color var(--transition-time);"><a class="back" onclick="back()" style="display: block; opacity: 1; height: 50px; transition: color var(--transition-time); background-color: rgba(0,0,0,0)"><i class="fa fa-angle-left"></i></a></div><h1 style="color: var(--col-label-text); text-align: center; display: block; position: fixed; width: 100%; top: 40%; font-size: 250%; font-family: Avenir; transition: color var(--transition-time);">Invalid User</h1>';
						document.title = "Invalid User";
						console.error(SyntaxError);
					}
				} catch (TypeError) {
					document.documentElement.style.setProperty('--transition-time', '0.5s');
					document.body.innerHTML = '<button class="openbtn" style="position: fixed; left: 0px; bottom: 0px; z-index: 2;" onclick="theme_()" id="themebtn"><i class="fa fa-fw fa-moon-o"> </i></button><sq><a href="javascript:home()" style="display:block;"><svg id="homeSvg" style="fill:#eee;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 460.298 460.297" style="enable-background:new 0 0 460.298 460.297;" xml:space="preserve"><g><g><path d="M230.149,120.939L65.986,256.274c0,0.191-0.048,0.472-0.144,0.855c-0.094,0.38-0.144,0.656-0.144,0.852v137.041c0,4.948,1.809,9.236,5.426,12.847c3.616,3.613,7.898,5.431,12.847,5.431h109.63V303.664h73.097v109.64h109.629c4.948,0,9.236-1.814,12.847-5.435c3.617-3.607,5.432-7.898,5.432-12.847V257.981c0-0.76-0.104-1.334-0.288-1.707L230.149,120.939z"/><path d="M457.122,225.438L394.6,173.476V56.989c0-2.663-0.856-4.853-2.574-6.567c-1.704-1.712-3.894-2.568-6.563-2.568h-54.816c-2.666,0-4.855,0.856-6.57,2.568c-1.711,1.714-2.566,3.905-2.566,6.567v55.673l-69.662-58.245c-6.084-4.949-13.318-7.423-21.694-7.423c-8.375,0-15.608,2.474-21.698,7.423L3.172,225.438c-1.903,1.52-2.946,3.566-3.14,6.136c-0.193,2.568,0.472,4.811,1.997,6.713l17.701,21.128c1.525,1.712,3.521,2.759,5.996,3.142c2.285,0.192,4.57-0.476,6.855-1.998L230.149,95.817l197.57,164.741c1.526,1.328,3.521,1.991,5.996,1.991h0.858c2.471-0.376,4.463-1.43,5.996-3.138l17.703-21.125c1.522-1.906,2.189-4.145,1.991-6.716C460.068,229.007,459.021,226.961,457.122,225.438z"/></g></g></svg></a></sq><div class="topSticky" style="border: none; background-color: rgba(0,0,0,0); transition: color var(--transition-time);"><a class="back" onclick="back()" style="display: block; opacity: 1; height: 50px; transition: color var(--transition-time); background-color: rgba(0,0,0,0)"><i class="fa fa-angle-left"></i></a></div><h1 style="color: var(--col-label-text); text-align: center; display: block; position: fixed; width: 100%; top: 40%; font-size: 250%; font-family: Avenir; transition: color var(--transition-time);">Invalid User</h1>';
					document.title = "Invalid User";
					console.error(TypeError);				
				}
			}
			
			if (user.id == 452673) document.querySelector('.topSticky h1').style = "font-family: Lilita One; font-size: 22px; font-weight: 400; color: #f30;";
			if (user.id == 5757897) document.querySelector(`button[onclick="showChannel('Published')"]`).innerHTML = "You found";
			if (user.id == 5757897) document.querySelector(`button[onclick="showChannel('Favorites')"]`).innerHTML = "Eâ€™s Picks";
			
			//Set User Information
			doCORSRequest(
				{
					method: 'GET',
					url: "https://community.gethopscotch.com/api/v2/users/" + user.id
					//data: dataField.value
				}, function printResult(result) {
					userReal = JSON.parse(result);
					console.log(userReal);
					document.title = userReal.nickname;
					if (result == "{}") {
						document.body.innerHTML = '<button class="openbtn" style="position: fixed; left: 0px; bottom: 0px; z-index: 2;" onclick="theme_()" id="themebtn"><i class="fa fa-fw fa-moon-o"> </i></button><sq><a href="javascript:home()" style="display:block;"><svg id="homeSvg" style="fill:#eee;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="40px" height="40px" viewBox="0 0 460.298 460.297" style="enable-background:new 0 0 460.298 460.297;" xml:space="preserve"><g><g><path d="M230.149,120.939L65.986,256.274c0,0.191-0.048,0.472-0.144,0.855c-0.094,0.38-0.144,0.656-0.144,0.852v137.041c0,4.948,1.809,9.236,5.426,12.847c3.616,3.613,7.898,5.431,12.847,5.431h109.63V303.664h73.097v109.64h109.629c4.948,0,9.236-1.814,12.847-5.435c3.617-3.607,5.432-7.898,5.432-12.847V257.981c0-0.76-0.104-1.334-0.288-1.707L230.149,120.939z"/><path d="M457.122,225.438L394.6,173.476V56.989c0-2.663-0.856-4.853-2.574-6.567c-1.704-1.712-3.894-2.568-6.563-2.568h-54.816c-2.666,0-4.855,0.856-6.57,2.568c-1.711,1.714-2.566,3.905-2.566,6.567v55.673l-69.662-58.245c-6.084-4.949-13.318-7.423-21.694-7.423c-8.375,0-15.608,2.474-21.698,7.423L3.172,225.438c-1.903,1.52-2.946,3.566-3.14,6.136c-0.193,2.568,0.472,4.811,1.997,6.713l17.701,21.128c1.525,1.712,3.521,2.759,5.996,3.142c2.285,0.192,4.57-0.476,6.855-1.998L230.149,95.817l197.57,164.741c1.526,1.328,3.521,1.991,5.996,1.991h0.858c2.471-0.376,4.463-1.43,5.996-3.138l17.703-21.125c1.522-1.906,2.189-4.145,1.991-6.716C460.068,229.007,459.021,226.961,457.122,225.438z"/></g></g></svg></a></sq><div class="topSticky" style="border: none; background-color: rgba(0,0,0,0); transition: color var(--transition-time);"><a class="back" onclick="back()" style="display: block; opacity: 1; height: 50px; transition: color var(--transition-time); background-color: rgba(0,0,0,0)"><i class="fa fa-angle-left"></i></a></div><h1 style="color: var(--col-label-text); text-align: center; display: block; position: fixed; width: 100%; top: 40%; font-size: 250%; font-family: Avenir; transition: color var(--transition-time);">Invalid User</h1>';
						document.title = "Invalid User";
					}
					document.querySelector(".topSticky h1").innerHTML = userReal.nickname.htmlEscape();
					document.querySelector(".topnav span").innerHTML = "Hopscotchin&rsquo; since " + new Date(userReal.created_at).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })
          document.querySelector(".topnav .flex div img").src = (userReal.remote_avatar_url == undefined) ? ("../images/webavatars/" + avPath + userReal.avatar_type + ".png") : userReal.remote_avatar_url;
					
					var badgeHTML = (badges.users[user.id]||[]).repeatEach((b)=>{
						return `'<ae badge="${b}" title="${badges.titles[b-1]}"></ae>'`.replace(/^'|'$/g,'');
					}).join('');
					
					//if (badgeHTML != "") {
						// var badgeDiv = document.createElement('div');
            let badgeDiv = document.querySelector('.badge-container')
						badgeDiv.innerHTML = '<span style="display: inline-flex;line-height: 48px;font-size:24px;font-family: sans-serif;"><img src="../images/profile-mushrooms.png" style="top:-2px;position:relative;margin:0;display:inline-block;width:48px;height:48px;"/> &ic; ' + userReal.plants + "</span><br/>" + badgeHTML;
						document.querySelector("#loadingBear").style.top = "calc(50% + 120px)";
						document.querySelector('.topnav .flex').appendChild(badgeDiv);//, document.querySelector('.topnav .flex div'));
					//}
					
					//Make the created at date a number_of_stars
					var num_stats = {
						joined: (function(str){
							var month = (["unk","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]).indexOf(str.split(/\s/)[0].match(/.../)[0]);
							return str.split(/\s/)[1] + "_" + ((month<10) ? "0"+month : String(month));
						})(user.created_at||"unknown"),
						id: user.id,
						imgUrl: (user.remote_avatar_url||"").replace(/^.*\/|\.png/g,'')
					};
					console.log(userReal, num_stats);
					userString = hexaUID.uuidToAid(String(num_stats.id))+"-"+hexaUID.uuidToAid(num_stats.joined)+((num_stats.imgUrl=="")?'':"-" + hexaUID.uuidToAid(num_stats.imgUrl));
					
					//console.log(user.created_at + " " + user.id + " " + user.remote_avatar_url.replace(/^.*\/|\.png/g,''));

          // Provide a List of Avatar IDs for each profile color
          const HSAvatar = {
            Bear: 0,
            Cupcake: 1,
            Gorilla: 2,
            Monkey: 3,
            SpacePod: 4,
            Dino: 5,
            Octopus: 6,
            Frog: 7,
            Banyan: 8,
            Parrot: 9,
            Astro: 10,
            Raccoon: 11,
            Stargirl: 12,
            Robo: 13,
            Bird: 14,
            Chillanna: 15,
            HopscotchTeam: 16,
            Avatar1: 17,
            Avatar2: 18,
            Avatar3: 19,
            Avatar4: 20,
            Avatar5: 21,
            Avatar6: 22,
            Avatar7: 23,
            Avatar8: 24,
            Avatar9: 25,
            Avatar10: 26,
            Avatar11: 27,
            Avatar12: 28,
            Avatar13: 29,
            Avatar14: 30,
            Avatar15: 31,
            Avatar16: 32,
            Custom: 33,
            NUMBER_OF_AVATAR_TYPES: 34
          }
          const colorMap = {
            // Blue
            '#2F35DF': [
              'Bear', 'SpacePod', 'Dino', 'Astro',
              'Robo', 'Avatar1', 'Avatar10', 'Avatar12',
              'Avatar14', 'Avatar16', 'Custom'
            ],
            // Turquoise
            '#59B1C2': [
              'Cupcake', 'Banyan', 'Raccoon', 'Bird',
              'Avatar2', 'Avatar8', 'Avatar11', 'Avatar13'
            ],
            // Green
            '#79B139': [
              'Gorilla', 'Frog'
            ],
            // Orange
            '#E9A944': [
              'Monkey', 'Octopus', 'Parrot', 'HopscotchTeam',
              'Avatar6', 'Avatar7', 'Avatar15'
            ],
            // Magenta
            '#EA4191': [
              'Stargirl', 'Chillanna', 'Avatar3', 'Avatar4',
              'Avatar5', 'Avatar9'
            ]
          }
          // Get the name of the user's avatar
          const avatarName = Object.keys(HSAvatar).find(name => HSAvatar[name] === userReal.avatar_type)
          // Find the color that contains the avatar name
          const buttonColor = Object.keys(colorMap).find(color => {
            return colorMap[color].indexOf(avatarName) !== -1
          })

          if (buttonColor) document.documentElement.style.setProperty('--col-btn-focused', buttonColor)
				}
			);
			
			//Show the default or specified channel
			if (/Published|Favorites/.test(channel)) {
				showChannel(channel);
			} else {
				showChannel("Published");
			}	
			if (window.history && window.history.pushState) {
				$(window).on('popstate', function() {      
					channel = url.searchParams.get("channel");
					if (/Published|Favorites/.test(channel)) {
						showChannel(channel);
					} else {
						showChannel("Published");
					}
				});
			}
			
			//NOTE TO SELF: In order to get latest PFP custom image, the user's most recent project will need to be checked. Also, outdated usernames need to auto-update.
			if (user.nickname) document.querySelector(".topSticky h1").innerHTML = user.nickname.htmlEscape();
			//document.title = user.nickname;
			document.querySelector(".topnav span").innerHTML = "Hopscotchin&rsquo; since " + user.created_at.replace("undefined 0000","unknown");
			if (user.avatar_type||user.remote_avatar_url) document.querySelector(".topnav img").src = (user.remote_avatar_url == undefined) ? ("../images/webavatars/" + avPath + user.avatar_type + ".png") : user.remote_avatar_url;
			if (document.referrer != "") {
				console.log("Referrer: " + document.referrer);
			}
			function back() {
				if (/ae-hopscotch.github.io/.test(document.referrer) || location.protocol != "https:") window.history.back(); else {console.warn("Cannot go back"); location.href = "index.html";}
			}
		</script>
	</body>
</html>